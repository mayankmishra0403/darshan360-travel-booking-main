import{j as e,P as m,L as N,b as Y,r as l,c as J,u as Q,A as Z}from"./index-DEwbglG8.js";import{b as T,c as ee,d as ae,e as te,f as ie,a as se}from"./trips-D8KeeC-s.js";import{c as ne}from"./bookings-BaXlddrq.js";import{c as oe}from"./payments-CkTTK7hh.js";import{m as o}from"./proxy-CcXE3Fd_.js";import{g as re}from"./hotels-B_rf1xHh.js";const $="/assets/VN20250817_175526-BcW1IVXW.mp4",M=({hotels:i,restaurants:a,foods:h})=>e.jsxs("div",{className:"place-amenities-section",children:[e.jsx(o.h2,{className:"amenities-title",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:"Services we provide"}),e.jsxs("div",{className:"amenities-grid",children:[e.jsxs("div",{className:"amenity-block",children:[e.jsx(o.h3,{className:"amenity-heading",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:"Hotels"}),i&&i.length?i.map((s,d)=>e.jsxs(o.div,{className:"amenity-card hotel-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25+d*.08},children:[e.jsx("img",{src:s.image,alt:s.name,className:"amenity-img"}),e.jsxs("div",{className:"amenity-info",children:[e.jsx("div",{className:"amenity-title",children:s.name}),e.jsx("div",{className:"amenity-desc",children:s.description}),e.jsxs("div",{className:"amenity-contact",children:["Manager: ",s.manager," | ",e.jsx("a",{href:`tel:${s.phone}`,children:s.phone})]}),e.jsx("div",{className:"amenity-location",children:s.location})]})]},d)):e.jsx("div",{className:"amenity-none",children:"No hotels listed."})]}),e.jsxs("div",{className:"amenity-block",children:[e.jsx(o.h3,{className:"amenity-heading",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},children:"Restaurants"}),a&&a.length?a.map((s,d)=>e.jsxs(o.div,{className:"amenity-card restaurant-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25+d*.08},children:[e.jsx("img",{src:s.image,alt:s.name,className:"amenity-img"}),e.jsxs("div",{className:"amenity-info",children:[e.jsx("div",{className:"amenity-title",children:s.name}),e.jsx("div",{className:"amenity-desc",children:s.description}),e.jsxs("div",{className:"amenity-contact",children:["Contact: ",e.jsx("a",{href:`tel:${s.phone}`,children:s.phone})]}),e.jsx("div",{className:"amenity-location",children:s.location})]})]},d)):e.jsx("div",{className:"amenity-none",children:"No restaurants listed."})]})]}),e.jsxs("div",{className:"food-section",children:[e.jsx(o.h3,{className:"amenity-heading",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:"Popular Foods"}),e.jsx("div",{className:"food-grid",children:h&&h.length?h.map((s,d)=>e.jsxs(o.div,{className:"food-card",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.35+d*.07},children:[e.jsx("img",{src:s.image,alt:s.name,className:"food-img"}),e.jsxs("div",{className:"food-info",children:[e.jsx("div",{className:"food-title",children:s.name}),e.jsx("div",{className:"food-desc",children:s.description})]})]},d)):e.jsx("div",{className:"amenity-none",children:"No food items listed."})})]})]});M.propTypes={hotels:m.array,restaurants:m.array,foods:m.array};const V=({stop:i})=>{const a=i!=null&&i.imageId?T(i.imageId,{full:!1}):"";return e.jsxs("div",{className:"stop-card",children:[e.jsxs("div",{className:"stop-image-wrap",children:[a?e.jsx("img",{src:a,alt:i.name,className:"stop-image",onError:h=>{h.currentTarget.src="/react.svg"}}):e.jsx("div",{className:"stop-image placeholder"}),e.jsxs("div",{className:"stop-overlay",children:[e.jsx("div",{className:"stop-title",children:i.name}),e.jsx(N,{to:`/stops/${i.id}`,className:"stop-arrow-box",title:"Open stop details",children:e.jsx("span",{className:"stop-arrow",children:"➜"})})]})]}),i.description&&e.jsx("div",{className:"stop-desc",children:i.description})]})},C=({stops:i})=>e.jsxs("section",{className:"stops-grid-section my-6",children:[e.jsx("h2",{className:"stops-title",children:"Places we visited"}),e.jsx("div",{className:"stops-grid",children:i.map(a=>e.jsx(V,{stop:a},a.id))})]});C.propTypes={stops:m.array.isRequired};V.propTypes={stop:m.shape({id:m.string,tripId:m.string,name:m.string,description:m.string,imageId:m.string}).isRequired};const le={Varanasi:[{name:"Spice Villa",location:"Godowlia, Varanasi",description:"Authentic North Indian cuisine with a modern twist. Famous for thalis and lassi.",phone:"+91 9988776655",image:"https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=400&q=80"},{name:"Rooftop Cafe",location:"Assi Ghat, Varanasi",description:"Chill rooftop cafe with Ganga views, continental and local snacks.",phone:"+91 9876543211",image:"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?auto=format&fit=crop&w=400&q=80"}],Prayagraj:[{name:"Sangam Diner",location:"Civil Lines, Prayagraj",description:"Family restaurant serving Indian and Chinese cuisine. Known for quick service.",phone:"+91 9123456789",image:"https://images.unsplash.com/photo-1528605248644-14dd04022da1?auto=format&fit=crop&w=400&q=80"}]};function ce(i){return le[i]||[]}const de={Varanasi:[{name:"Kachori Sabzi",description:"Crispy kachoris served with spicy potato curry, a Varanasi breakfast staple.",image:"https://images.unsplash.com/photo-1502741338009-cac2772e18bc?auto=format&fit=crop&w=400&q=80"},{name:"Banarasi Paan",description:"Iconic sweet paan with a burst of flavors, a must-try after meals.",image:"https://images.unsplash.com/photo-1519864600265-abb23847ef2c?auto=format&fit=crop&w=400&q=80"}],Prayagraj:[{name:"Chaat",description:"Tangy and spicy street food, a favorite among locals and tourists alike.",image:"https://images.unsplash.com/photo-1464306076886-debca5e8a6b0?auto=format&fit=crop&w=400&q=80"}]};function me(i){return de[i]||[]}function ve(){const{id:i}=Y(),[a,h]=l.useState(null),[s,d]=l.useState(!0),[y,E]=l.useState(0),g=l.useRef(!0),w=J(),{isAdmin:R,user:x}=Q(),[F,I]=l.useState(!1),[k,A]=l.useState({x:0,y:0}),[B,L]=l.useState("blue"),f=l.useRef(null);l.useEffect(()=>{(async()=>{try{const t=await ee(i);h(t)}catch(t){console.error(t)}finally{d(!1)}})()},[i]);const[p,q]=l.useState([]),[v,z]=l.useState(null),[D,j]=l.useState(!1),P=t=>{try{const n=document.getElementById(t);if(!n)return;const r=n.play();r&&typeof r.then=="function"&&r.then(()=>j(!1)).catch(()=>j(!0))}catch(n){console.warn("play attempt failed",n),j(!0)}};l.useEffect(()=>{(async()=>{try{if(a!=null&&a.id){const t=await ae(a.id);console.info("Loaded stops for trip",a.id,t),q(t)}}catch(t){console.error(t)}})()},[a==null?void 0:a.id]),l.useEffect(()=>{try{const t=new URLSearchParams(w.search),n=t.get("focus")||t.get("stopId");if(n&&p&&p.length){const r=p.findIndex(X=>X.id===n);r>=0&&(E(r+1),g.current=!1)}}catch(t){console.error(t)}},[w.search,p]);const b=l.useMemo(()=>({blue:{primary:"from-blue-400 to-cyan-400",secondary:"from-blue-100 to-cyan-100",accent:"blue-500",shadow:"shadow-blue-200/50",glow:"ring-blue-300"},purple:{primary:"from-purple-400 to-pink-400",secondary:"from-purple-100 to-pink-100",accent:"purple-500",shadow:"shadow-purple-200/50",glow:"ring-purple-300"},orange:{primary:"from-orange-400 to-red-400",secondary:"from-orange-100 to-red-100",accent:"orange-500",shadow:"shadow-orange-200/50",glow:"ring-orange-300"},green:{primary:"from-green-400 to-emerald-400",secondary:"from-green-100 to-emerald-100",accent:"green-500",shadow:"shadow-green-200/50",glow:"ring-green-300"}}),[]);l.useEffect(()=>{const t=Object.keys(b),n=t[y%t.length];L(n)},[y,b]);const H=t=>{if(f.current){const n=f.current.getBoundingClientRect();A({x:(t.clientX-n.left)/n.width*100,y:(t.clientY-n.top)/n.height*100})}},u=b[B];if(s)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mb-4 mx-auto"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Loading your adventure..."})]})});const O=()=>!p||p.length===0?e.jsxs("div",{className:"my-6 p-4 bg-yellow-50 border border-yellow-200 rounded text-yellow-800",children:["No places found for this trip.",R&&e.jsx("div",{className:"mt-2",children:e.jsx("a",{href:"/admin",className:"text-sm text-blue-600 underline",children:"Open Admin panel"})})]}):e.jsx(C,{stops:p});if(!a)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🗺️"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Trip not found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"This adventure seems to have wandered off the map"}),e.jsx(N,{to:"/",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold transition-colors",children:"Explore Other Trips"})]})});const U=re(a.title),G=ce(a.title),K=me(a.title),S=te(a.imageIds),W=Array.isArray(a.imageIds)&&a.imageIds.length>0?a.imageIds[0]:null,_=a.videoId||null,c=[{kind:"trip",title:a.title,description:a.description||`Experience ${p.length} amazing destinations on this journey`,imageId:W,videoId:_,isMainSlide:!0},...p.map(t=>({kind:"stop",title:t.name,description:t.description,imageId:t.imageId,videoId:t.videoId,isMainSlide:!1}))][y]||null;return e.jsxs("div",{ref:f,className:"max-w-6xl mx-auto p-4 transition-all duration-700",onMouseMove:H,onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),style:{background:`radial-gradient(circle at ${k.x}% ${k.y}%, rgba(59, 130, 246, 0.05) 0%, transparent 50%)`},children:[e.jsx("div",{className:`fixed inset-0 pointer-events-none transition-opacity duration-1000 ${F?"opacity-20":"opacity-10"}`,style:{background:`linear-gradient(135deg, ${u.secondary})`,zIndex:-1}}),e.jsxs(o.section,{className:`relative h-[75vh] sm:h-[85vh] md:h-[75vh] rounded-2xl overflow-hidden transition-all duration-500 ${u.shadow} hover:shadow-2xl`,whileHover:{scale:1.02,y:-5},transition:{type:"spring",stiffness:300,damping:30},children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 z-0",children:[...Array(15)].map((t,n)=>e.jsx(o.div,{className:`absolute rounded-full bg-gradient-to-br ${u.primary} opacity-30`,style:{width:`${15+Math.random()*30}px`,height:`${15+Math.random()*30}px`,left:`${Math.random()*90}%`,bottom:`${Math.random()*80}%`},animate:{y:[0,-20,0],rotate:[0,180,360],scale:[1,1.2,1]},transition:{duration:3+Math.random()*4,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},n))}),e.jsx(Z,{initial:!1,children:e.jsxs(o.div,{initial:g.current?!1:{x:320,opacity:0,scale:.92,rotate:8},animate:{x:0,opacity:1,scale:1,rotate:0,transition:{type:"spring",stiffness:180,damping:22,duration:.55}},exit:g.current?!1:{x:-320,opacity:0,scale:.92,rotate:-8,transition:{type:"spring",stiffness:180,damping:22,duration:.45}},className:"absolute inset-0 w-full h-full",style:{zIndex:1},children:[c!=null&&c.videoId?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx(o.video,{id:`trip-video-${a.id||i}`,src:v||(c.kind==="trip"?ie(c.videoId):se(c.videoId))||$,className:"w-full h-full object-cover",style:{filter:"brightness(0.97) saturate(1.05)"},controls:!0,autoPlay:!0,playsInline:!0,loop:!0,onCanPlay:()=>{P(`trip-video-${a.id||i}`)},onError:()=>{v||z($)}},`v-${c.videoId}-${v||"server"}`),D&&e.jsx("div",{className:"absolute inset-0 z-30 flex items-center justify-center pointer-events-auto",children:e.jsx("button",{onClick:()=>P(`trip-video-${a.id||i}`),className:"bg-white/90 text-gray-900 px-6 py-3 rounded-full font-semibold shadow-lg","aria-label":"Play video with sound",children:"▶ Play with sound"})})]}):c!=null&&c.imageId?e.jsx(o.img,{src:T(c.imageId),alt:(c==null?void 0:c.title)||a.title,className:"w-full h-full object-contain sm:object-cover object-center",style:{filter:"brightness(0.97) saturate(1.15)"},whileHover:{scale:1.05},transition:{duration:.3}}):S[0]?e.jsx(o.img,{src:S[0],alt:a.title,className:"w-full h-full object-cover",style:{filter:"brightness(0.97) saturate(1.15)"},whileHover:{scale:1.05},transition:{duration:.3}}):e.jsx("div",{className:`w-full h-full bg-gradient-to-br ${u.secondary} flex items-center justify-center`}),e.jsx(o.div,{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-black/10",animate:{background:"linear-gradient(to top, rgba(0,0,0,0.6), rgba(0,0,0,0.2), rgba(0,0,0,0.1))"}})]},y)}),e.jsx(o.div,{className:"relative z-20 h-full flex flex-col justify-end p-6 sm:p-10 text-white",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:e.jsx(o.div,{className:"w-full flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:e.jsx("div",{className:"text-center",children:x?e.jsx(o.button,{onClick:async()=>{try{const t=new Date().toISOString(),n=`upi_${Date.now()}`;try{await ne({id:n,tripId:a.id,tripTitle:a.title,userId:x.$id,status:"pending",date:t});try{await oe({id:n,data:{orderId:n,tripId:a.id,tripTitle:a.title,userId:x.$id,status:"created",amount:Number(a.price)*100,currency:"INR",date:t}})}catch(r){console.warn("Payment create fallback failed",(r==null?void 0:r.message)||r)}}catch(r){console.warn("Book now fallback failed",(r==null?void 0:r.message)||r)}window.open("https://rzp.io/rzp/kPlkKOD","_blank","noopener")}catch(t){console.error(t)}},className:"bg-gradient-to-r from-blue-600 via-purple-600 to-orange-500 text-white px-8 py-4 rounded-2xl font-semibold hover:shadow-xl transition-all",children:"Book Now"}):e.jsx(N,{to:"/login",className:"text-[#FD366E] font-medium underline",children:"Login to Book"})})})})]}),e.jsx(o.div,{className:"mt-6 grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:[{label:"Trip",value:a.title,icon:"🗺️"},{label:"Date",value:a.date||"Flexible",icon:"📅"},{label:"Price",value:`₹${a.price}`,icon:"💰"}].map((t,n)=>e.jsx(o.div,{className:`bg-white/90 backdrop-blur-sm rounded-xl p-6 transition-all duration-300 border border-white/20 hover:${u.shadow} hover:border-white/40`,whileHover:{scale:1.05,y:-8,boxShadow:"0 20px 40px rgba(0,0,0,0.1)"},whileTap:{scale:.98},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4+n*.1,duration:.5},style:{background:"linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7))"},children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:t.icon}),e.jsxs("div",{children:[e.jsxs("span",{className:`font-semibold text-${u.accent}`,children:[t.label,":"]}),e.jsx("p",{className:"text-gray-700 font-medium",children:t.value})]})]})},t.label))}),e.jsx(o.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.5,duration:.6},children:O()}),e.jsx(o.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.6,duration:.6},className:"mt-8",children:e.jsx(M,{hotels:U,restaurants:G,foods:K})})]})}export{ve as default};
