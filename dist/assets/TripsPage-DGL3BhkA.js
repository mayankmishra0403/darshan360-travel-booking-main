import{u as w,r as x,j as e,L as u,P as t}from"./index-DEwbglG8.js";import{g as j,l as N}from"./trips-D8KeeC-s.js";import{c as b}from"./bookings-BaXlddrq.js";import{c as v}from"./payments-CkTTK7hh.js";import{m as f}from"./proxy-CcXE3Fd_.js";function y({trip:r,onPay:n}){var h;const{user:d}=w(),[c,m]=x.useState(!1),[a,o]=x.useState(!1),l=j((h=r.imageIds)==null?void 0:h[0]),g=r.price?`₹${Number(r.price).toLocaleString()}`:"Price on request";return e.jsxs(f.div,{whileHover:{y:-10,scale:1.04},whileTap:{scale:.98},className:"group relative bg-white rounded-3xl shadow-xl transition-all duration-300 overflow-hidden border-2 border-transparent tripcard-illuminated",style:{boxShadow:"0 0 0 0 rgba(0,0,0,0.1)"},children:[e.jsxs("div",{className:"relative h-64 overflow-hidden z-20",children:[l&&!a?e.jsxs(e.Fragment,{children:[!c&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-200 to-gray-300 animate-pulse flex items-center justify-center",children:e.jsx("div",{className:"text-4xl",children:"🏞️"})}),e.jsx(u,{to:`/trips/${r.id}`,className:"block w-full h-full",children:e.jsx("img",{loading:"lazy",src:l,alt:r.title,className:`w-full h-full object-cover transition-all duration-700 group-hover:scale-110 ${c?"opacity-100":"opacity-0"}`,onLoad:()=>m(!0),onError:()=>o(!0),style:{filter:"brightness(0.98) saturate(1.15)"}})})]}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-100 to-purple-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-gray-600",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📸"}),e.jsx("div",{className:"text-sm",children:"Image unavailable"})]})}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("div",{className:"bg-white/95 backdrop-blur-sm text-gray-900 px-3 py-2 rounded-full font-bold text-sm shadow-lg",children:g})}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("div",{className:"bg-orange-500/90 backdrop-blur-sm text-white px-3 py-1 rounded-full text-xs font-semibold",children:"Featured"})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsxs("div",{className:"p-6 z-20 relative",children:[e.jsx("h3",{className:"text-2xl font-extrabold text-gray-900 mb-3 line-clamp-2 group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-blue-500 group-hover:via-purple-500 group-hover:to-orange-500 transition-all duration-300",children:e.jsx(u,{to:`/trips/${r.id}`,className:"hover:underline",children:r.title})}),e.jsxs("div",{className:"flex items-center text-gray-600 text-sm mb-4",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),r.date||"Flexible dates"]}),Array.isArray(r.stops)&&r.stops.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2 font-medium",children:"Experience Highlights:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[r.stops.slice(0,3).map((s,i)=>e.jsx("span",{className:"inline-block bg-gradient-to-r from-blue-100 via-purple-100 to-orange-100 text-blue-700 text-xs px-2 py-1 rounded-full border border-blue-200 shadow-sm",children:s},i)),r.stops.length>3&&e.jsxs("span",{className:"inline-block bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full",children:["+",r.stops.length-3," more"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex text-yellow-400",children:[...Array(5)].map((s,i)=>e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},i))}),e.jsx("span",{className:"text-gray-600 text-sm ml-2",children:"4.8 (47)"})]}),e.jsx("span",{className:"bg-green-100 text-green-700 text-xs px-2 py-1 rounded-full font-medium",children:"Available"})]}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[d?e.jsx(f.button,{whileHover:{scale:1.12,boxShadow:"0 0 24px 6px #a78bfa, 0 0 48px 12px #fbbf24, 0 0 16px 4px #60a5fa"},whileTap:{scale:.96},onClick:async()=>{try{const s=new Date().toISOString(),i=`upi_${Date.now()}`;await b({id:i,tripId:r.id,tripTitle:r.title,userId:d.$id,status:"pending",date:s});try{await v({id:i,data:{orderId:i,tripId:r.id,tripTitle:r.title,userId:d.$id,status:"created",amount:Number(r.price)*100,currency:"INR",date:s}})}catch(p){console.warn("Payment create fallback failed",(p==null?void 0:p.message)||p)}}catch(s){console.warn("Book now fallback failed",(s==null?void 0:s.message)||s)}window.open("https://rzp.io/rzp/kPlkKOD","_blank","noopener"),n==null||n(r)},className:"flex-1 bg-gradient-to-r from-blue-600 via-purple-600 to-orange-500 hover:from-blue-700 hover:to-orange-600 text-white py-3 px-4 rounded-xl font-semibold transition-all duration-200 shadow-lg hover:shadow-2xl border-2 border-transparent hover:border-orange-400 focus:outline-none focus:ring-4 focus:ring-orange-300",style:{boxShadow:"0 0 16px 2px #a78bfa, 0 0 32px 8px #fbbf24, 0 0 8px 2px #60a5fa"},children:"Book Now"}):e.jsx(u,{to:"/login",className:"flex-1 bg-gradient-to-r from-blue-600 via-purple-600 to-orange-500 hover:from-blue-700 hover:to-orange-600 text-white py-3 px-4 rounded-xl font-semibold text-center transition-all duration-200 shadow-lg hover:shadow-2xl border-2 border-transparent hover:border-orange-400 focus:outline-none focus:ring-4 focus:ring-orange-300",style:{boxShadow:"0 0 16px 2px #a78bfa, 0 0 32px 8px #fbbf24, 0 0 8px 2px #60a5fa"},children:"Login to Book"}),e.jsx(u,{to:`/trips/${r.id}`,className:"bg-gray-100 hover:bg-gradient-to-r hover:from-blue-100 hover:via-purple-100 hover:to-orange-100 text-gray-700 py-3 px-4 rounded-xl font-medium transition-all duration-200 flex items-center justify-center border border-gray-200 hover:border-blue-400 focus:outline-none focus:ring-4 focus:ring-blue-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]})]})}y.propTypes={trip:t.shape({id:t.string.isRequired,title:t.string.isRequired,price:t.oneOfType([t.number,t.string]).isRequired,date:t.string,imageIds:t.arrayOf(t.string),stops:t.arrayOf(t.string)}).isRequired,onPay:t.func};function $(){const[r,n]=x.useState([]),[d,c]=x.useState(!0);x.useEffect(()=>{let a=!0;async function o(){c(!0);try{const l=await N();a&&n(l)}catch(l){console.error("Failed to load trips",l)}finally{a&&c(!1)}}return o(),()=>a=!1},[]);async function m(a){try{const o=await b({tripId:a.$id||a.id,status:"pending",amount:a.price||0,createdAt:new Date().toISOString()});try{await v({bookingId:o.$id||o.id,status:"pending",method:"upi",amount:a.price||0,createdAt:new Date().toISOString()})}catch(g){console.warn("Failed to create payment record",g)}window.open("https://rzp.io/rzp/kPlkKOD","_blank","noopener")}catch(o){console.error("Failed to create fallback booking",o),alert("Failed to create booking. Please try again.")}}return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Explore Destinations"}),d?e.jsx("div",{className:"text-center py-20",children:"Loading trips..."}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(a=>e.jsx(y,{trip:a,onPay:()=>m(a)},a.$id||a.id))})]})}export{$ as default};
