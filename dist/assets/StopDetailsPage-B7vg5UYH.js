import{b as E,r as s,j as t,L as w,A as I}from"./index-DEwbglG8.js";import{h as L,b as A}from"./trips-D8KeeC-s.js";import{m as M}from"./proxy-CcXE3Fd_.js";function C(){const{id:m}=E(),[n,v]=s.useState(null),[N,k]=s.useState(!0),[h,o]=s.useState(0),[x,f]=s.useState(0),u=s.useRef(!0),r=s.useRef(null);s.useEffect(()=>{(async()=>{try{const e=await L(m);v(e)}catch(e){console.error(e)}finally{k(!1)}})()},[m]);const a=Array.isArray(n==null?void 0:n.images)?n.images:n!=null&&n.imageId?[n.imageId]:[],l=s.useCallback(()=>{f(1),o(e=>(e+1)%Math.max(1,a.length)),u.current=!1},[a.length]),c=s.useCallback(()=>{f(-1),o(e=>(e-1+Math.max(1,a.length))%Math.max(1,a.length)),u.current=!1},[a.length]);s.useEffect(()=>{o(0),u.current=!0},[a.length]),s.useEffect(()=>{const e=i=>{i.key==="ArrowLeft"&&c(),i.key==="ArrowRight"&&l()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[l,c]);const g=e=>{var i;r.current=e.clientX||e.touches&&((i=e.touches[0])==null?void 0:i.clientX)||null},p=e=>{var y;const i=e.clientX||e.changedTouches&&((y=e.changedTouches[0])==null?void 0:y.clientX)||null;if(r.current==null||i==null)return;const j=i-r.current;Math.abs(j)>50&&(j>0?c():l()),r.current=null};if(N)return t.jsx("div",{className:"p-6",children:"Loading stop..."});if(!n)return t.jsxs("div",{className:"p-6",children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Stop not found"}),t.jsx(w,{to:"/",children:"Back"})]});const d=a.length>0?a[h]:null,b=d?A(d,{full:!1}):"",S={enter:e=>({x:e>0?300:-300,opacity:0}),center:{x:0,opacity:1},exit:e=>({x:e>0?-300:300,opacity:0})};return t.jsxs("div",{className:"p-4 max-w-5xl mx-auto",children:[t.jsxs("section",{className:"relative h-80 md:h-96 rounded overflow-hidden bg-gray-200",children:[t.jsx(I,{initial:!1,custom:x,children:t.jsx(M.div,{custom:x,variants:S,initial:"enter",animate:"center",exit:"exit",transition:{type:"tween",duration:.45},className:"absolute inset-0 flex items-center justify-center bg-black/10",onMouseDown:g,onMouseUp:p,onTouchStart:g,onTouchEnd:p,children:b?t.jsx("img",{src:b,alt:n.name,className:"w-full h-full object-cover"}):t.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:"No image"})},d||"empty")}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-black/10"}),t.jsx("div",{className:"absolute bottom-3 left-3 z-20 text-white",children:t.jsx("h2",{className:"text-lg font-bold",children:n.name})}),t.jsxs("div",{className:"absolute bottom-3 right-3 z-20 flex gap-2 items-center",children:[t.jsx("div",{className:"text-sm mr-3 text-white/90",children:a.length>0?`${h+1} / ${a.length}`:"0 / 0"}),t.jsx("button",{onClick:c,className:"bg-white/20 text-white px-3 py-1 rounded",children:"◀"}),t.jsx("button",{onClick:l,className:"bg-white/20 text-white px-3 py-1 rounded",children:"▶"})]})]}),t.jsx("div",{className:"text-gray-700 my-4",children:n.description}),t.jsx("div",{children:t.jsx(w,{to:`/trips/${n.tripId}`,className:"text-blue-600 underline",children:"Back to trip"})})]})}export{C as default};
