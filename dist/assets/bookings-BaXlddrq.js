import{d as u,Q as y,e as g,R as m}from"./index-DEwbglG8.js";const d="travel_db",k="bookings";async function f(e){const o=(await u.listDocuments(d,k,[y.equal("userId",e)])).documents.map(t=>({id:t.$id,tripId:t.tripId,tripTitle:t.tripTitle,status:t.status,date:t.date}));try{const t=localStorage.getItem("local_bookings");if(t){const r=JSON.parse(t),i=Array.isArray(r)?r.filter(s=>s.userId===e):[],a=new Set(o.map(s=>s.id));return[...o,...i.filter(s=>!a.has(s.id))]}}catch(t){console.warn("Failed to read local bookings fallback:",(t==null?void 0:t.message)||t)}return o}async function b({id:e,tripId:n,tripTitle:c,userId:o,status:t,date:r}){const i=[g.read(m.user(o)),g.update(m.user(o))];return await u.createDocument(d,k,e,{tripId:n,tripTitle:c,userId:o,status:t,date:r},i)}async function w({id:e,tripId:n,tripTitle:c,userId:o,status:t,date:r}){try{return await b({id:e,tripId:n,tripTitle:c,userId:o,status:t,date:r})}catch(i){try{const a=localStorage.getItem("local_bookings"),l=a?JSON.parse(a):[],s={id:e,tripId:n,tripTitle:c,userId:o,status:t,date:r};return l.push(s),localStorage.setItem("local_bookings",JSON.stringify(l)),s}catch(a){throw console.warn("Failed to save local booking fallback:",(a==null?void 0:a.message)||a),i}}}export{w as c,f as l};
