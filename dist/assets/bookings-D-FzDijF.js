import{d as u,Q as y,a as g,R as m}from"./index-CLjvfxVe.js";const d="travel_db",k="bookings";async function f(e){const a=(await u.listDocuments(d,k,[y.equal("userId",e)])).documents.map(t=>({id:t.$id,tripId:t.tripId,tripTitle:t.tripTitle,status:t.status,date:t.date}));try{const t=localStorage.getItem("local_bookings");if(t){const r=JSON.parse(t),i=Array.isArray(r)?r.filter(s=>s.userId===e):[],o=new Set(a.map(s=>s.id));return[...a,...i.filter(s=>!o.has(s.id))]}}catch(t){console.warn("Failed to read local bookings fallback:",(t==null?void 0:t.message)||t)}return a}async function b({id:e,tripId:n,tripTitle:c,userId:a,status:t,date:r}){const i=[g.read(m.user(a)),g.update(m.user(a))];return await u.createDocument(d,k,e,{tripId:n,tripTitle:c,userId:a,status:t,date:r},i)}async function w({id:e,tripId:n,tripTitle:c,userId:a,status:t,date:r}){try{return await b({id:e,tripId:n,tripTitle:c,userId:a,status:t,date:r})}catch(i){try{const o=localStorage.getItem("local_bookings"),l=o?JSON.parse(o):[],s={id:e,tripId:n,tripTitle:c,userId:a,status:t,date:r};return l.push(s),localStorage.setItem("local_bookings",JSON.stringify(l)),s}catch(o){throw console.warn("Failed to save local booking fallback:",(o==null?void 0:o.message)||o),i}}}export{w as c,f as l};
