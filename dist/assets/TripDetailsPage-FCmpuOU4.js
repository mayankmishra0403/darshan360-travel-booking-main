import{j as e,P as p,L as k,c as J,r as c,e as Y,u as Q,A as Z}from"./index-CLjvfxVe.js";import{b as C,c as ee,d as ae,e as te,f as ie,a as se}from"./trips-BOHQsqPE.js";import{m as r}from"./proxy-B5GhTnH_.js";import{g as ne}from"./hotels-B_rf1xHh.js";const E="/assets/VN20250817_175526-BcW1IVXW.mp4";async function oe(i){const a=await fetch("/.netlify/functions/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!a.ok){const n=await a.json();throw new Error(n.message||"Failed to create Razorpay order")}return a.json()}function re(){return new Promise((i,a)=>{if(document.getElementById("razorpay-script"))return i(!0);const n=document.createElement("script");n.id="razorpay-script",n.src="https://checkout.razorpay.com/v1/checkout.js",n.onload=()=>i(!0),n.onerror=()=>a(new Error("Razorpay SDK failed to load")),document.body.appendChild(n)})}async function le({key:i,order:a,user:n,onSuccess:s,onFailure:l}){return await re(),new Promise((u,b)=>{const x={key:i,amount:a.amount,currency:a.currency,name:"Darshan 360",description:a.description||"Trip booking",order_id:a.id,prefill:{name:n==null?void 0:n.name,email:n==null?void 0:n.email},handler:function(h){s==null||s(h),u(h);const d=document.createElement("div");d.style.position="fixed",d.style.top="0",d.style.left="0",d.style.width="100%",d.style.height="100%",d.style.backgroundColor="rgba(255, 255, 255, 0.9)",d.style.display="flex",d.style.justifyContent="center",d.style.alignItems="center",d.style.zIndex="9999",d.innerHTML=`
          <div style="text-align: center; background: white; padding: 2rem; border-radius: 1rem; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
            <h2 style="color: #16a34a; margin-bottom: 1rem;">Payment Successful!</h2>
            <p style="color: #4b5563;">Redirecting to your bookings...</p>
          </div>
        `,document.body.appendChild(d),setTimeout(()=>{window.location.href="/bookings"},4e3)},modal:{ondismiss:()=>{l==null||l(),b(new Error("Payment closed"))},escape:!1},theme:{color:"#FD366E"}},v=new window.Razorpay(x);v.on("payment.failed",function(h){l==null||l((h==null?void 0:h.error)||h),b(new Error("Payment failed"))}),v.open()})}const R=({hotels:i,restaurants:a,foods:n})=>e.jsxs("div",{className:"place-amenities-section",children:[e.jsx(r.h2,{className:"amenities-title",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:"Services we provide"}),e.jsxs("div",{className:"amenities-grid",children:[e.jsxs("div",{className:"amenity-block",children:[e.jsx(r.h3,{className:"amenity-heading",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:"Hotels"}),i&&i.length?i.map((s,l)=>e.jsxs(r.div,{className:"amenity-card hotel-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25+l*.08},children:[e.jsx("img",{src:s.image,alt:s.name,className:"amenity-img"}),e.jsxs("div",{className:"amenity-info",children:[e.jsx("div",{className:"amenity-title",children:s.name}),e.jsx("div",{className:"amenity-desc",children:s.description}),e.jsxs("div",{className:"amenity-contact",children:["Manager: ",s.manager," | ",e.jsx("a",{href:`tel:${s.phone}`,children:s.phone})]}),e.jsx("div",{className:"amenity-location",children:s.location})]})]},l)):e.jsx("div",{className:"amenity-none",children:"No hotels listed."})]}),e.jsxs("div",{className:"amenity-block",children:[e.jsx(r.h3,{className:"amenity-heading",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},children:"Restaurants"}),a&&a.length?a.map((s,l)=>e.jsxs(r.div,{className:"amenity-card restaurant-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25+l*.08},children:[e.jsx("img",{src:s.image,alt:s.name,className:"amenity-img"}),e.jsxs("div",{className:"amenity-info",children:[e.jsx("div",{className:"amenity-title",children:s.name}),e.jsx("div",{className:"amenity-desc",children:s.description}),e.jsxs("div",{className:"amenity-contact",children:["Contact: ",e.jsx("a",{href:`tel:${s.phone}`,children:s.phone})]}),e.jsx("div",{className:"amenity-location",children:s.location})]})]},l)):e.jsx("div",{className:"amenity-none",children:"No restaurants listed."})]})]}),e.jsxs("div",{className:"food-section",children:[e.jsx(r.h3,{className:"amenity-heading",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:"Popular Foods"}),e.jsx("div",{className:"food-grid",children:n&&n.length?n.map((s,l)=>e.jsxs(r.div,{className:"food-card",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.35+l*.07},children:[e.jsx("img",{src:s.image,alt:s.name,className:"food-img"}),e.jsxs("div",{className:"food-info",children:[e.jsx("div",{className:"food-title",children:s.name}),e.jsx("div",{className:"food-desc",children:s.description})]})]},l)):e.jsx("div",{className:"amenity-none",children:"No food items listed."})})]})]});R.propTypes={hotels:p.array,restaurants:p.array,foods:p.array};const M=({stop:i})=>{const a=i!=null&&i.imageId?C(i.imageId,{full:!1}):"";return e.jsxs("div",{className:"stop-card",children:[e.jsxs("div",{className:"stop-image-wrap",children:[a?e.jsx("img",{src:a,alt:i.name,className:"stop-image",onError:n=>{n.currentTarget.src="/react.svg"}}):e.jsx("div",{className:"stop-image placeholder"}),e.jsxs("div",{className:"stop-overlay",children:[e.jsx("div",{className:"stop-title",children:i.name}),e.jsx(k,{to:`/stops/${i.id}`,className:"stop-arrow-box",title:"Open stop details",children:e.jsx("span",{className:"stop-arrow",children:"âžœ"})})]})]}),i.description&&e.jsx("div",{className:"stop-desc",children:i.description})]})},z=({stops:i})=>e.jsxs("section",{className:"stops-grid-section my-6",children:[e.jsx("h2",{className:"stops-title",children:"Places we visited"}),e.jsx("div",{className:"stops-grid",children:i.map(a=>e.jsx(M,{stop:a},a.id))})]});z.propTypes={stops:p.array.isRequired};M.propTypes={stop:p.shape({id:p.string,tripId:p.string,name:p.string,description:p.string,imageId:p.string}).isRequired};const ce={Varanasi:[{name:"Spice Villa",location:"Godowlia, Varanasi",description:"Authentic North Indian cuisine with a modern twist. Famous for thalis and lassi.",phone:"+91 9988776655",image:"https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=400&q=80"},{name:"Rooftop Cafe",location:"Assi Ghat, Varanasi",description:"Chill rooftop cafe with Ganga views, continental and local snacks.",phone:"+91 9876543211",image:"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?auto=format&fit=crop&w=400&q=80"}],Prayagraj:[{name:"Sangam Diner",location:"Civil Lines, Prayagraj",description:"Family restaurant serving Indian and Chinese cuisine. Known for quick service.",phone:"+91 9123456789",image:"https://images.unsplash.com/photo-1528605248644-14dd04022da1?auto=format&fit=crop&w=400&q=80"}]};function de(i){return ce[i]||[]}const me={Varanasi:[{name:"Kachori Sabzi",description:"Crispy kachoris served with spicy potato curry, a Varanasi breakfast staple.",image:"https://images.unsplash.com/photo-1502741338009-cac2772e18bc?auto=format&fit=crop&w=400&q=80"},{name:"Banarasi Paan",description:"Iconic sweet paan with a burst of flavors, a must-try after meals.",image:"https://images.unsplash.com/photo-1519864600265-abb23847ef2c?auto=format&fit=crop&w=400&q=80"}],Prayagraj:[{name:"Chaat",description:"Tangy and spicy street food, a favorite among locals and tourists alike.",image:"https://images.unsplash.com/photo-1464306076886-debca5e8a6b0?auto=format&fit=crop&w=400&q=80"}]};function pe(i){return me[i]||[]}function xe(){const{id:i}=J(),[a,n]=c.useState(null),[s,l]=c.useState(!0),[u,b]=c.useState(0),x=c.useRef(!0),v=Y(),{isAdmin:h,user:d}=Q(),[V,P]=c.useState(!1),[S,A]=c.useState({x:0,y:0}),[L,B]=c.useState("blue"),j=c.useRef(null);c.useEffect(()=>{(async()=>{try{const t=await ee(i);n(t)}catch(t){console.error(t)}finally{l(!1)}})()},[i]);const[y,q]=c.useState([]),[w,H]=c.useState(null),[D,N]=c.useState(!1),T=t=>{try{const o=document.getElementById(t);if(!o)return;const f=o.play();f&&typeof f.then=="function"&&f.then(()=>N(!1)).catch(()=>N(!0))}catch(o){console.warn("play attempt failed",o),N(!0)}};c.useEffect(()=>{(async()=>{try{if(a!=null&&a.id){const t=await ae(a.id);console.info("Loaded stops for trip",a.id,t),q(t)}}catch(t){console.error(t)}})()},[a==null?void 0:a.id]),c.useEffect(()=>{try{const t=new URLSearchParams(v.search),o=t.get("focus")||t.get("stopId");if(o&&y&&y.length){const f=y.findIndex(X=>X.id===o);f>=0&&(b(f+1),x.current=!1)}}catch(t){console.error(t)}},[v.search,y]);const I=c.useMemo(()=>({blue:{primary:"from-blue-400 to-cyan-400",secondary:"from-blue-100 to-cyan-100",accent:"blue-500",shadow:"shadow-blue-200/50",glow:"ring-blue-300"},purple:{primary:"from-purple-400 to-pink-400",secondary:"from-purple-100 to-pink-100",accent:"purple-500",shadow:"shadow-purple-200/50",glow:"ring-purple-300"},orange:{primary:"from-orange-400 to-red-400",secondary:"from-orange-100 to-red-100",accent:"orange-500",shadow:"shadow-orange-200/50",glow:"ring-orange-300"},green:{primary:"from-green-400 to-emerald-400",secondary:"from-green-100 to-emerald-100",accent:"green-500",shadow:"shadow-green-200/50",glow:"ring-green-300"}}),[]);c.useEffect(()=>{const t=Object.keys(I),o=t[u%t.length];B(o)},[u,I]);const O=t=>{if(j.current){const o=j.current.getBoundingClientRect();A({x:(t.clientX-o.left)/o.width*100,y:(t.clientY-o.top)/o.height*100})}},g=I[L];if(s)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mb-4 mx-auto"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Loading your adventure..."})]})});const U=()=>!y||y.length===0?e.jsxs("div",{className:"my-6 p-4 bg-yellow-50 border border-yellow-200 rounded text-yellow-800",children:["No places found for this trip.",h&&e.jsx("div",{className:"mt-2",children:e.jsx("a",{href:"/admin",className:"text-sm text-blue-600 underline",children:"Open Admin panel"})})]}):e.jsx(z,{stops:y});if(!a)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ—ºï¸"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Trip not found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"This adventure seems to have wandered off the map"}),e.jsx(k,{to:"/",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold transition-colors",children:"Explore Other Trips"})]})});const F=ne(a.title),G=de(a.title),K=pe(a.title),$=te(a.imageIds),_=Array.isArray(a.imageIds)&&a.imageIds.length>0?a.imageIds[0]:null,W=a.videoId||null,m=[{kind:"trip",title:a.title,description:a.description||`Experience ${y.length} amazing destinations on this journey`,imageId:_,videoId:W,isMainSlide:!0},...y.map(t=>({kind:"stop",title:t.name,description:t.description,imageId:t.imageId,videoId:t.videoId,isMainSlide:!1}))][u]||null;return e.jsxs("div",{ref:j,className:"max-w-6xl mx-auto p-4 transition-all duration-700",onMouseMove:O,onMouseEnter:()=>P(!0),onMouseLeave:()=>P(!1),style:{background:`radial-gradient(circle at ${S.x}% ${S.y}%, rgba(59, 130, 246, 0.05) 0%, transparent 50%)`},children:[e.jsx("div",{className:`fixed inset-0 pointer-events-none transition-opacity duration-1000 ${V?"opacity-20":"opacity-10"}`,style:{background:`linear-gradient(135deg, ${g.secondary})`,zIndex:-1}}),e.jsxs(r.section,{className:`relative h-[75vh] sm:h-[85vh] md:h-[75vh] rounded-2xl overflow-hidden transition-all duration-500 ${g.shadow} hover:shadow-2xl`,whileHover:{scale:1.02,y:-5},transition:{type:"spring",stiffness:300,damping:30},children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 z-0",children:[...Array(15)].map((t,o)=>e.jsx(r.div,{className:`absolute rounded-full bg-gradient-to-br ${g.primary} opacity-30`,style:{width:`${15+Math.random()*30}px`,height:`${15+Math.random()*30}px`,left:`${Math.random()*90}%`,bottom:`${Math.random()*80}%`},animate:{y:[0,-20,0],rotate:[0,180,360],scale:[1,1.2,1]},transition:{duration:3+Math.random()*4,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},o))}),e.jsx(Z,{initial:!1,children:e.jsxs(r.div,{initial:x.current?!1:{x:320,opacity:0,scale:.92,rotate:8},animate:{x:0,opacity:1,scale:1,rotate:0,transition:{type:"spring",stiffness:180,damping:22,duration:.55}},exit:x.current?!1:{x:-320,opacity:0,scale:.92,rotate:-8,transition:{type:"spring",stiffness:180,damping:22,duration:.45}},className:"absolute inset-0 w-full h-full",style:{zIndex:1},children:[m!=null&&m.videoId?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx(r.video,{id:`trip-video-${a.id||i}`,src:w||(m.kind==="trip"?ie(m.videoId):se(m.videoId))||E,className:"w-full h-full object-cover",style:{filter:"brightness(0.97) saturate(1.05)"},controls:!0,autoPlay:!0,playsInline:!0,loop:!0,onCanPlay:()=>{T(`trip-video-${a.id||i}`)},onError:()=>{w||H(E)}},`v-${m.videoId}-${w||"server"}`),D&&e.jsx("div",{className:"absolute inset-0 z-30 flex items-center justify-center pointer-events-auto",children:e.jsx("button",{onClick:()=>T(`trip-video-${a.id||i}`),className:"bg-white/90 text-gray-900 px-6 py-3 rounded-full font-semibold shadow-lg","aria-label":"Play video with sound",children:"â–¶ Play with sound"})})]}):m!=null&&m.imageId?e.jsx(r.img,{src:C(m.imageId),alt:(m==null?void 0:m.title)||a.title,className:"w-full h-full object-contain sm:object-cover object-center",style:{filter:"brightness(0.97) saturate(1.15)"},whileHover:{scale:1.05},transition:{duration:.3}}):$[0]?e.jsx(r.img,{src:$[0],alt:a.title,className:"w-full h-full object-cover",style:{filter:"brightness(0.97) saturate(1.15)"},whileHover:{scale:1.05},transition:{duration:.3}}):e.jsx("div",{className:`w-full h-full bg-gradient-to-br ${g.secondary} flex items-center justify-center`}),e.jsx(r.div,{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-black/10",animate:{background:"linear-gradient(to top, rgba(0,0,0,0.6), rgba(0,0,0,0.2), rgba(0,0,0,0.1))"}})]},u)}),e.jsx(r.div,{className:"relative z-20 h-full flex flex-col justify-end p-6 sm:p-10 text-white",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:e.jsx(r.div,{className:"w-full flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:e.jsx("div",{className:"text-center",children:d?e.jsx(r.button,{onClick:async()=>{try{const t=await oe({amount:Number(a.price)*100,currency:"INR",receipt:`trip_${a.id}`});await le({key:void 0,order:t,user:d,onSuccess:o=>{console.log("Payment successful",o)},onFailure:o=>{console.error("Payment failed",o)}})}catch(t){console.error(t)}},className:"bg-gradient-to-r from-blue-600 via-purple-600 to-orange-500 text-white px-8 py-4 rounded-2xl font-semibold hover:shadow-xl transition-all",children:"Book Now"}):e.jsx(k,{to:"/login",className:"text-[#FD366E] font-medium underline",children:"Login to Book"})})})})]}),e.jsx(r.div,{className:"mt-6 grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:[{label:"Trip",value:a.title,icon:"ðŸ—ºï¸"},{label:"Date",value:a.date||"Flexible",icon:"ðŸ“…"},{label:"Price",value:`â‚¹${a.price}`,icon:"ðŸ’°"}].map((t,o)=>e.jsx(r.div,{className:`bg-white/90 backdrop-blur-sm rounded-xl p-6 transition-all duration-300 border border-white/20 hover:${g.shadow} hover:border-white/40`,whileHover:{scale:1.05,y:-8,boxShadow:"0 20px 40px rgba(0,0,0,0.1)"},whileTap:{scale:.98},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4+o*.1,duration:.5},style:{background:"linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7))"},children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:t.icon}),e.jsxs("div",{children:[e.jsxs("span",{className:`font-semibold text-${g.accent}`,children:[t.label,":"]}),e.jsx("p",{className:"text-gray-700 font-medium",children:t.value})]})]})},t.label))}),e.jsx(r.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.5,duration:.6},children:U()}),e.jsx(r.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.6,duration:.6},className:"mt-8",children:e.jsx(R,{hotels:F,restaurants:G,foods:K})})]})}export{xe as default};
